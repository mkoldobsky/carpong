<!DOCTYPE html>
<html>
  <body>
    <canvas
      id="carCanvas"
      width="300"
      height="600"
      style="background-color: black"
    ></canvas>
    <script>
      const canvas = document.getElementById("carCanvas");
      const ctx = canvas.getContext("2d");

      let x = 0;
      let y = 0;
      let carPosition = 150;
      let obstacles = [{ visible: true, x: 0, y: 0 }];
      function draw() {
        ctx.clearRect(0, 0, 400, 800);
        drawLines();
        drawCar(carPosition);
        drawObstacles();
        checkCollision();
        y++;
        y = y % 800;
      }
      function drawLines() {
        ctx.fillStyle = "yellow";
        for (let index = 0; index < 19; index++) {
          ctx.fillRect(145, index * 30 + 10, 10, 20);
        }
      }
      function drawCar(x) {
        ctx.fillStyle = "white";
        ctx.fillRect(x - 20, 555, 40, 40);
        ctx.fillRect(x - 30, 555, 5, 10);
        ctx.fillRect(x - 30, 585, 5, 10);
        ctx.fillRect(x + 25, 555, 5, 10);
        ctx.fillRect(x + 25, 585, 5, 10);
      }
      function moveCar(from, to) {
        drawCar(to);
      }
      function drawObstacles() {
        ctx.fillStyle = "white";
        if (obstacles.length < 10) {
          addObstacle();
        }
        for (let index = 0; index < obstacles.length; index++) {
          const obstacle = obstacles[index];
          ctx.fillRect(obstacle.x, obstacle.y, 100, 10);
          obstacle.y++;
        }
      }
      function addObstacle() {
        let tail = obstacles[obstacles.length - 1];
        let x = Math.floor(Math.random() * 3) * 100;
        obstacles.push({ visible: true, x: x, y: tail.y - 100 });
      }
      function checkCollision() {}
      function keyHandler() {
        document.addEventListener("keydown", (event) => {
          switch (event.key) {
            case "ArrowLeft":
              moveCar(carPosition, carPosition - 10);
              carPosition -= 10;
              break;
            case "ArrowRight":
              moveCar(carPosition, carPosition + 10);
              carPosition += 10;
              break;
            default:
              break;
          }
        });
      }

      keyHandler();
      setInterval(draw, 30);
    </script>
  </body>
</html>
